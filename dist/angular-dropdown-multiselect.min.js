!function(){"use strict";angular.module("dropdown-multiselect",[]).directive("dropdownMultiselect",["$timeout",function(e){return{restrict:"AE",replace:!0,transclude:!0,template:'<div class="dropdown" id="dropdownMultiselect"><button class="btn btn-default dropdown-toggle" ng-class="{\'disabled\':disabled}" type="button" id="dropdownMenu"><span class="pull-left" ng-if="!hasText">Select </span><span class="pull-left" ng-transclude></span><div class="pull-right"><span class="badge" ng-if="isBadgeVisible"> {{model.length}}</span><span class="caret"></span></div></button><ul class="dropdown-menu"><li><div><ul class="dropdown-static"><li ng-if="multiSelect"><a ng-click="selectAll()"><i class="glyphicon glyphicon-ok"></i> Select All</a></li><li ng-if="multiSelect"><a ng-click="unSelectAll()"><i class="glyphicon glyphicon-remove"></i> Unselect All</a></li><div class="filter-parent" id="search" ng-if="isFilterVisible"><label for="filter-by"><i class="glyphicon glyphicon-search"></i></label><div><input placeholder="Search" id="filter-by" class="form-control" tabindex="1" ng-model="$parent.option"></div></div></ul></div></li><li><ul class="dropdown-scrollable" ng-class="{\'dropdown-height\': defaultHeight, \'hasfilter\': isFilterVisible === true}"><li ng-repeat="option in options | filter: option"><a ng-click="setSelectedItem()"><span class="pull-right" ng-class="isChecked(option[trackByKey], dropdownType)"></span> {{option[leftKey]}} {{divider}} {{option[rightKey]}}</a></li></ul></li></ul></div>',scope:{config:"=dropdownConfig",primaryKey:"@dropdownTrackby",disableDropdown:"=dropdownDisable",dropdownType:"=",model:"=?",dropdownOptions:"=dropdownOptions",notifyParent:"&dropdownSelected"},controller:function(n){function o(){n.preSelectAll&&n.multiSelect&&e(n.selectAll)}function r(){var e=[];for(var o in n.options[0])e.push(o);n.leftKey=e[0],n.rightKey=e[1]}function t(e){if(angular.isUndefined(e)&&(e=n.options[0].hasOwnProperty("Id")?"Id":!!n.options[0].hasOwnProperty("id")&&"id",n.trackByKey=e,e===!1))throw'ReferenceError: Expecting property "Id" in an object from an array binded to "dropdown-options" attribute. Consider providing "dropdown-trackby" attribute or make sure property "Id" exists in binded array\'s object.'}function l(e,o){for(var r=0;r<o.length;r++){var t=o[r][n.trackByKey];if(e===t){var l=i(o,n.trackByKey,e);return o.splice(l,1),!0}}}function i(e,n,o){for(var r=0;r<e.length;r++)if(e[r][n]===o)return r;return null}var a,d=[],s=!0,c=!0,u=!1,p="-",g="glyphicon glyphicon-ok",f=(n.dropdownType,n.primaryKey);n.trackByKey=f,n.isBadgeVisible=s,n.isFilterVisible=u,n.divider=p,n.multiSelect=c,n.model=d;try{if(angular.isUndefined(n.dropdownOptions)&&angular.isUndefined(n.config))throw"Error: Missing array for dropdown list. Consider providing array through [dropdown-options] or [dropdown-config] attribute in the directive tag.";angular.isDefined(n.dropdownOptions)&&(n.options=n.dropdownOptions,r()),angular.isDefined(n.config)?(n.config.hasOwnProperty("options")&&(n.options=n.config.options),n.config.hasOwnProperty("displayBy")?(n.leftKey=n.config.displayBy[0],n.rightKey=n.config.displayBy[1]):r(),n.config.hasOwnProperty("divider")&&(n.divider=n.config.divider),n.config.hasOwnProperty("icon")&&(g=n.config.icon),n.config.hasOwnProperty("filter")&&(u=n.config.filter,n.isFilterVisible=u),n.config.hasOwnProperty("displayBadge")&&(s=s=!!angular.equals(!0,n.config.displayBadge),n.isBadgeVisible=s),n.config.hasOwnProperty("multiSelect")&&(c=!!angular.equals(!0,n.config.multiSelect),n.multiSelect=c),n.config.hasOwnProperty("preSelectAll")&&(a=!!angular.equals(!0,n.config.preSelectAll),n.preSelectAll=a),n.config.hasOwnProperty("trackBy")?(f=n.config.trackBy,n.trackByKey=f):t(f)):t(f);n.$watch("options",function(e,o){n.disableDropdown?n.disabled=!0:n.disabled=!1,e&&(d=[],n.model=d)});n.selectAll=function(){var e=n.options;if(angular.isUndefined(e))return!1;if(e.length===d.length)return!1;for(var o=0;o<e.length;o++){for(var r=e[o][n.trackByKey],t=(e[o].ChainId,{}),l=!1,i=0;i<d.length;i++){var a=d[i][n.trackByKey];if(r===a){l=!0;break}}l||(t[n.trackByKey]=r,d.push(e[o]))}n.notifyParent({selected:d})},n.unSelectAll=function(){d=[],n.model=d,n.notifyParent({selected:d})},n.setSelectedItem=function(){var e=this.option[n.trackByKey],o=(this.option.ChainId,{});if(c===!1)return!l(e,d)&&(d[0]=this.option,!1);var r=l(e,d);r||(o[n.trackByKey]=e,this.option.selected=!0,d.push(this.option)),n.notifyParent({selected:d})},n.isChecked=function(e,o){for(var r=0;r<d.length;r++)if(d[r][n.trackByKey]===e)return g;return!1},o()}catch(e){console.error(e)}},link:function(e,n,o,r){function t(e){var n=document.getElementById("dropdownMultiselect"),o=angular.isDefined(e.srcElement)?e.srcElement.offsetParent:e.originalTarget.offsetParent;if(null!==o){for(var r,t=o;t!==n;){angular.element(document.querySelector(".dropdown-menu"));if(t=t.offsetParent,r=!0,null===t){r=!1;break}}if(null===t)return angular.element(document.querySelector(".dropdown-menu")).removeClass("dropdown-show"),angular.element(document.querySelector(".dropdown-menu")).css("display","none"),!1;if(null===t||t===n&&!r){var l=angular.element(document.querySelector(".dropdown-menu"));console.log(l),"dropdown-show"===angular.element(document.querySelector(".dropdown-menu"))[0].classList[1]?(angular.element(document.querySelector(".dropdown-menu")).removeClass("dropdown-show"),angular.element(document.querySelector(".dropdown-menu")).css("display","none")):(angular.element(document.querySelector(".dropdown-menu")).addClass("dropdown-show"),angular.element(document.querySelector(".dropdown-menu")).css("display","block"))}}else angular.element(document.querySelector(".dropdown-menu")).removeClass("dropdown-show"),angular.element(document.querySelector(".dropdown-menu")).css("display","none")}function l(e){var n=document.getElementById("dropdownMultiselect"),o=angular.isDefined(e.srcElement)?e.srcElement.offsetParent:e.originalTarget.offsetParent;if(null!==o){for(var r,t=o;t!==n;){angular.element(document.querySelector(".dropdown-menu"));if(t=t.offsetParent,r=!0,null===t){r=!1;break}}if(angular.isDefined(r)&&!r)return angular.element(document.querySelector(".dropdown-menu")).removeClass("dropdown-show"),angular.element(document.querySelector(".dropdown-menu")).css("display","none"),i=!1}else angular.element(document.querySelector(".dropdown-menu")).removeClass("dropdown-show"),angular.element(document.querySelector(".dropdown-menu")).css("display","none")}var i=!1;n.bind("click",function(e){var n,o=document.getElementById("dropdownMultiselect");if(n=angular.isDefined(e.originalEvent)?angular.isDefined(e.originalEvent.srcElement)?e.originalEvent.srcElement.offsetParent:e.originalEvent.originalTarget.offsetParent:angular.isDefined(e.srcElement)?e.srcElement.offsetParent:e.originalTarget.offsetParent,null!==n){for(var r,t=n;t!==o;){angular.element(document.querySelector(".dropdown-menu"));if(t=t.offsetParent,r=!0,null===t){r=!1;break}}if(null===t)return angular.element(document.querySelector(".dropdown-menu")).removeClass("dropdown-show"),angular.element(document.querySelector(".dropdown-menu")).css("display","none"),!1;if(null===t||t===o&&!r){angular.element(document.querySelector(".dropdown-menu"));i===!0?(angular.element(document.querySelector(".dropdown-menu")).removeClass("dropdown-show"),angular.element(document.querySelector(".dropdown-menu")).css("display","none")):(angular.element(document.querySelector(".dropdown-menu")).addClass("dropdown-show"),angular.element(document.querySelector(".dropdown-menu")).css("display","block")),i=!i}}else angular.element(document.querySelector(".dropdown-menu")).removeClass("dropdown-show"),angular.element(document.querySelector(".dropdown-menu")).css("display","none")}),"ontouchstart"in window?document.addEventListener("touchstart",t,!1):document.addEventListener("mouseup",l,!1);var a=angular.element(document.querySelector(".dropdown-scrollable"));if(angular.isDefined(e.config)&&angular.isDefined(e.config.height)){var d=e.config.height;a.css("max-height",d)}else e.defaultHeight=!0;e.multiSelect===!1&&e.isFilterVisible===!0?a.css("margin-top","50px"):e.multiSelect===!1&&e.isFilterVisible===!1&&a.css("margin-top","10px");var s=n.find("span").contents();e.hasText=s.length>1}}}])}();